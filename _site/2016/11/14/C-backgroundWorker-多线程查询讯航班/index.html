<!DOCTYPE html>
<html>
<head>

  <meta charset="UTF-8">
  <title>C# backgroundWorker 多线程查询讯航班</title>
  <meta name="viewport" content="width=device-width">

  <!--[if lt IE 9]>
    <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->

  <link href="/assets/css/style.css" rel="stylesheet" />
  <link href="/assets/css/colors-dark.css" rel="stylesheet" />

</head>

<body>



  <header id="header">
    <h1><a href="/"><i class="icon-sun"></i> Solar Theme</a></h1>
    <p>A stylish blog using the Solarized color palette</p>
  </header>



  <div id="page">



    <div id="sidebar">
      <nav>
        <ul>
          <li><a href="/">Home</a></li>
          <li><a href="/archives">Archive</a></li>
          <li><a href="/about">About</a></li>
          <li><a href="http://twitter.com/redwall_hp">Twitter</a></li>
          <li><a href="/feed.xml">RSS Feed</a></li>
        </ul>
      </nav>
    </div>



    <div id="content">
      <article class="post">

	
		<h1><a href="/2016/11/14/C-backgroundWorker-%E5%A4%9A%E7%BA%BF%E7%A8%8B%E6%9F%A5%E8%AF%A2%E8%AE%AF%E8%88%AA%E7%8F%AD/">C# backgroundWorker 多线程查询讯航班</a></h1>
	

	<div class="post-content"><p>效果：</p>
<div><a href="http://photo.blog.sina.com.cn/showpic.html#blogid=8265bd790102v2lw&amp;url=http://album.sina.com.cn/pic/002o3oc9zy6MwQA3bwka8" target="_blank"><img style="margin: 0px; padding: 0px; border: 0px; list-style: none;" title="C# &lt;wbr&gt;backgroundWorker &lt;wbr&gt;多线程查询讯航班" src="http://s9.sinaimg.cn/mw690/002o3oc9zy6MwQA3bwka8&amp;690" alt="C# &lt;wbr&gt;backgroundWorker &lt;wbr&gt;多线程查询讯航班" width="690" height="332" name="image_operate_28221412338182124" /></a><br />
调用web service接口，返回结果，在listview中显示。</div>
<div>代码：</div>
<div>
<div>using multiThread_airplane.ServiceReference1;</div>
<div>using System;</div>
<div>using System.Collections.Generic;</div>
<div>using System.ComponentModel;</div>
<div>using System.Data;</div>
<div>using System.Drawing;</div>
<div>using System.Linq;</div>
<div>using System.Text;</div>
<div>using System.Windows.Forms;</div>
<div>using System.Collections;</div>
<div></div>
<div>namespace multiThread_airplane</div>
<div>{</div>
<div> <wbr />  <wbr /> public partial class Form1 : Form</div>
<div> <wbr />  <wbr /> {</div>
<div> <wbr />  <wbr />  <wbr />  <wbr /> BackgroundWorker bw = new BackgroundWorker();</div>
<div> <wbr />  <wbr />  <wbr />  <wbr /> DataSet end;</div>
<div> <wbr />  <wbr />  <wbr />  <wbr /> public Form1()</div>
<div> <wbr />  <wbr />  <wbr />  <wbr /> {</div>
<div> <wbr />  <wbr />  <wbr />  <wbr />  <wbr />  <wbr /> InitializeComponent();</div>
<div> <wbr />  <wbr />  <wbr />  <wbr /> }</div>
<div></div>
<div> <wbr />  <wbr />  <wbr />  <wbr /> private void Form1_Load(object sender, EventArgs e)</div>
<div> <wbr />  <wbr />  <wbr />  <wbr /> {</div>
<div> <wbr />  <wbr />  <wbr />  <wbr />  <wbr />  <wbr /> listView1.Columns.Add("航空公司", 80, HorizontalAlignment.Center);</div>
<div> <wbr />  <wbr />  <wbr />  <wbr />  <wbr />  <wbr /> listView1.Columns.Add("航班号", 80, HorizontalAlignment.Center);</div>
<div> <wbr />  <wbr />  <wbr />  <wbr />  <wbr />  <wbr /> listView1.Columns.Add("出发机场", 150, HorizontalAlignment.Center);</div>
<div> <wbr />  <wbr />  <wbr />  <wbr />  <wbr />  <wbr /> listView1.Columns.Add("到达机场", 150, HorizontalAlignment.Center);</div>
<div> <wbr />  <wbr />  <wbr />  <wbr />  <wbr />  <wbr /> listView1.Columns.Add("出发时间", 80, HorizontalAlignment.Center);</div>
<div> <wbr />  <wbr />  <wbr />  <wbr />  <wbr />  <wbr /> listView1.Columns.Add("到达时间", 80, HorizontalAlignment.Center);</div>
<div> <wbr />  <wbr />  <wbr />  <wbr />  <wbr />  <wbr /> listView1.Columns.Add("经停", 70, HorizontalAlignment.Center);</div>
<div> <wbr />  <wbr />  <wbr />  <wbr />  <wbr />  <wbr /> listView1.Columns.Add("飞行周期", 80, HorizontalAlignment.Center);</div>
<div> <wbr />  <wbr />  <wbr />  <wbr /> }</div>
<div></div>
<div> <wbr />  <wbr />  <wbr />  <wbr /> private void button1_Click(object sender, EventArgs e)</div>
<div> <wbr />  <wbr />  <wbr />  <wbr /> {</div>
<div> <wbr />  <wbr />  <wbr />  <wbr />  <wbr />  <wbr /> bw.DoWork +=new DoWorkEventHandler(doworker);</div>
<div> <wbr />  <wbr />  <wbr />  <wbr />  <wbr />  <wbr /> bw.RunWorkerCompleted += new RunWorkerCompletedEventH<wbr />andler(worker_completed);</div>
<div> <wbr />  <wbr />  <wbr />  <wbr />  <wbr />  <wbr /> bw.RunWorkerAsync();</div>
<div></div>
<div> <wbr />  <wbr />  <wbr />  <wbr /> }</div>
<div> <wbr />  <wbr />  <wbr />  <wbr /> public void doworker(object sender,DoWorkEventArgs e)</div>
<div> <wbr />  <wbr />  <wbr />  <wbr /> {</div>
<div> <wbr />  <wbr />  <wbr />  <wbr />  <wbr />  <wbr /> try</div>
<div> <wbr />  <wbr />  <wbr />  <wbr />  <wbr />  <wbr /> {</div>
<div> <wbr />  <wbr />  <wbr />  <wbr />  <wbr />  <wbr />  <wbr />  <wbr /> DomesticAirlineSoapClien<wbr />t client = new DomesticAirlineSoapClien<wbr />t("DomesticAirlineSoap");</div>
<div> <wbr />  <wbr />  <wbr />  <wbr />  <wbr />  <wbr />  <wbr />  <wbr /> end = client.getDomesticAirlinesTime(textBox1.Text, textBox2.Text, dateTimePicker1.Value.Year.ToString() + "-" + dateTimePicker1.Value.Month.ToString() + "-"+dateTimePicker1.Value.Day.ToString(),"");</div>
<div> <wbr />  <wbr />  <wbr />  <wbr />  <wbr />  <wbr /> }</div>
<div> <wbr />  <wbr />  <wbr />  <wbr />  <wbr />  <wbr /> catch(Exception ex)</div>
<div> <wbr />  <wbr />  <wbr />  <wbr />  <wbr />  <wbr /> {</div>
<div> <wbr />  <wbr />  <wbr />  <wbr />  <wbr />  <wbr />  <wbr />  <wbr /> MessageBox.Show(ex.Message);</div>
<div> <wbr />  <wbr />  <wbr />  <wbr />  <wbr />  <wbr /> }</div>
<div> <wbr />  <wbr />  <wbr />  <wbr /> }</div>
<div> <wbr />  <wbr />  <wbr />  <wbr /> public void worker_completed(object sender,RunWorkerCompletedEventA<wbr />rgs e)</div>
<div> <wbr />  <wbr />  <wbr />  <wbr /> {</div>
<div> <wbr />  <wbr />  <wbr />  <wbr />  <wbr />  <wbr /> DataTable dt = end.Tables[0];</div>
<div> <wbr />  <wbr />  <wbr />  <wbr />  <wbr />  <wbr /> foreach(DataRow dr in dt.Rows)</div>
<div> <wbr />  <wbr />  <wbr />  <wbr />  <wbr />  <wbr /> {</div>
<div> <wbr />  <wbr />  <wbr />  <wbr />  <wbr />  <wbr />  <wbr />  <wbr /> listView1.Items.Add(new ListViewItem(new string[] { dr[0].ToString(), dr[1].ToString(), dr[2].ToString(), dr[3].ToString(), dr[4].ToString(), dr[5].ToString(), dr[6].ToString(), dr[7].ToString() }));</div>
<div> <wbr />  <wbr />  <wbr />  <wbr />  <wbr />  <wbr /> }</div>
<div> <wbr />  <wbr />  <wbr />  <wbr /> }</div>
<div> <wbr />  <wbr /> }</div>
<div>}</div>
</div>
</div>

	<p class="meta">Posted on <span class="postdate">Nov 14, 2016</span></p>

</article>
    </div>



  </div>



  <footer id="footer">
    <p class="copyright">Copyright &copy; 2017 Solar Theme. Powered by <a href="http://jekyllrb.com">Jekyll</a>, theme by <a href="http://www.webmaster-source.com">Matt Harzewski</a></p>
  </footer>



  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.1/jquery.min.js"></script>
  <script src="/assets/js/jquery.mobilemenu.min.js"></script>

  <script>
    $(document).ready(function(){
      $('#sidebar nav ul').mobileMenu({'topOptionText': 'Menu', 'prependTo': '#sidebar nav'});
    });
  </script>



</body>
</html>