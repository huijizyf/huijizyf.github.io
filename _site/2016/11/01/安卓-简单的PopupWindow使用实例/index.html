<!DOCTYPE html>
<html>
<head>

  <meta charset="UTF-8">
  <title>安卓 简单的PopupWindow使用实例</title>
  <meta name="viewport" content="width=device-width">

  <!--[if lt IE 9]>
    <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->

  <link href="/assets/css/style.css" rel="stylesheet" />
  <link href="/assets/css/colors-dark.css" rel="stylesheet" />

</head>

<body>



  <header id="header">
    <h1><a href="/"><i class="icon-sun"></i> Solar Theme</a></h1>
    <p>A stylish blog using the Solarized color palette</p>
  </header>



  <div id="page">



    <div id="sidebar">
      <nav>
        <ul>
          <li><a href="/">Home</a></li>
          <li><a href="/archives">Archive</a></li>
          <li><a href="/about">About</a></li>
          <li><a href="http://twitter.com/redwall_hp">Twitter</a></li>
          <li><a href="/feed.xml">RSS Feed</a></li>
        </ul>
      </nav>
    </div>



    <div id="content">
      <article class="post">

	
		<h1><a href="/2016/11/01/%E5%AE%89%E5%8D%93-%E7%AE%80%E5%8D%95%E7%9A%84PopupWindow%E4%BD%BF%E7%94%A8%E5%AE%9E%E4%BE%8B/">安卓 简单的PopupWindow使用实例</a></h1>
	

	<div class="post-content"><p>什么是PopupWindow？</p>
<p>谷歌的描述是：“一个弹出窗口控件，可以用来显示任意视图(View)，而且会浮动在当前 活动(activity)的顶部”</p>
<p>下面展示一个最简单的实例</p>
<div>
<div><a href="http://photo.blog.sina.com.cn/showpic.html#blogid=8265bd790102vuah&amp;url=http://album.sina.com.cn/pic/002o3oc9gy6U9UOCD6y62" target="_blank"><img style="margin: 0px; padding: 0px; border: 0px; list-style: none; vertical-align: middle; max-width: 100%;" title="安卓 &lt;wbr&gt;简单的PopupWindow使用实例" src="http://s3.sinaimg.cn/mw690/002o3oc9gy6U9UOCD6y62" alt="安卓 &lt;wbr&gt;简单的PopupWindow使用实例" /></a>填写图片摘要（选填）</div>
</div>
<p>点击button时，弹出PopupWindow</p>
<p><wbr /></p>
<pre>public void showPopupWindow(View view) {
LayoutInflater inflater=LayoutInflater.from(this);
final View popView=inflater.inflate(R.layout.popupwindow_layout, null);//创建PopupWindow的内容视图
Button dismiss_bt= (Button) popView.findViewById(R.id.dismiss_bt);
final PopupWindow popupWindow=new PopupWindow(popView, ViewGroup.LayoutParams.MATCH_PARENT,ViewGroup.LayoutParams.WRAP_CONTENT, true);//创建PopupWindow
popupWindow.setTouchable(true);
popupWindow.setBackgroundDrawable(getResources().getDrawable(R.drawable.ba));//设置popupwindow的背景
dismiss_bt.setOnClickListener(new View.OnClickListener() {
@Override
public void onClick(View v) {
Toast.makeText(MainActivity.this, "button is pressed", Toast.LENGTH_SHORT).show();
popupWindow.dismiss();
}
});
popupWindow.showAsDropDown(view);//显示PopupWindow
}</pre>
<pre>PopupWindow的显示方法</pre>
<pre>
　　显示提供了两种形式：
　　使用showAtLocation()显示在指定位置，两个方法重载：</pre>
<div>
<pre>public void showAtLocation(View parent, int gravity, int x, int y)

public void showAtLocation(IBinder token, int gravity, int x, int y)
</pre>
</div>
<pre>
 <wbr />
　　使用showAsDropDown()显示在一个参照物View的周围，三个方法重载：</pre>
<div>
<pre>public void showAsDropDown(View anchor)

public void showAsDropDown(View anchor, int xoff, int yoff)

public void showAsDropDown(View anchor, int xoff, int yoff, int gravity)
</pre>
</div>
<pre>
public void showAsDropDown(View anchor, int xoff, int yoff, int gravity）方法是API 19新引入的。</pre>
<div>PopupWindow如果没有设置Background在按下Back键或点击PopupWindow外区域的时候不会Dismiss。</div>
<div><span style="font-family: Verdana, Arial, Helvetica, sans-serif;">原因：</span>如果有背景，则会在contentView外面包一层<strong>PopupViewContainer</strong>之后作为mPopupView，如果没有背景，则直接用contentView作为mPopupView。</div>
<p>而这个<strong>PopupViewContainer</strong>是一个内部私有类，它继承了FrameLayout，在其中重写了Key和Touch事件的分发处理。<strong>由于PopupView本身并没有重写Key和Touch事件的处理，所以如果没有包这个外层容器类，点击Back键或者外部区域是不会导致弹框消失的。</strong></p>
</div>

	<p class="meta">Posted on <span class="postdate">Nov 01, 2016</span></p>

</article>
    </div>



  </div>



  <footer id="footer">
    <p class="copyright">Copyright &copy; 2017 Solar Theme. Powered by <a href="http://jekyllrb.com">Jekyll</a>, theme by <a href="http://www.webmaster-source.com">Matt Harzewski</a></p>
  </footer>



  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.1/jquery.min.js"></script>
  <script src="/assets/js/jquery.mobilemenu.min.js"></script>

  <script>
    $(document).ready(function(){
      $('#sidebar nav ul').mobileMenu({'topOptionText': 'Menu', 'prependTo': '#sidebar nav'});
    });
  </script>



</body>
</html>