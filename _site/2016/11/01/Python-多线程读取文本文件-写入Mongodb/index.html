<!DOCTYPE html>
<html>
<head>

  <meta charset="UTF-8">
  <title>Python 多线程读取文本文件，写入Mongodb</title>
  <meta name="viewport" content="width=device-width">

  <!--[if lt IE 9]>
    <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->

  <link href="/assets/css/style.css" rel="stylesheet" />
  <link href="/assets/css/colors-dark.css" rel="stylesheet" />

</head>

<body>



  <header id="header">
    <h1><a href="/"><i class="icon-sun"></i> Solar Theme</a></h1>
    <p>A stylish blog using the Solarized color palette</p>
  </header>



  <div id="page">



    <div id="sidebar">
      <nav>
        <ul>
          <li><a href="/">Home</a></li>
          <li><a href="/archives">Archive</a></li>
          <li><a href="/about">About</a></li>
          <li><a href="http://twitter.com/redwall_hp">Twitter</a></li>
          <li><a href="/feed.xml">RSS Feed</a></li>
        </ul>
      </nav>
    </div>



    <div id="content">
      <article class="post">

	
		<h1><a href="/2016/11/01/Python-%E5%A4%9A%E7%BA%BF%E7%A8%8B%E8%AF%BB%E5%8F%96%E6%96%87%E6%9C%AC%E6%96%87%E4%BB%B6-%E5%86%99%E5%85%A5Mongodb/">Python 多线程读取文本文件，写入Mongodb</a></h1>
	

	<div class="post-content"><p>安卓MongoDb及MongoDb的使用方法就不说了，网上有很好的教程，可以参考：http://www.cnblogs.com/huangxincheng/archive/2012/02/18/2356595.html</p>
<div>安装好Python环境，使用pip install pymongo安装连接MongoDb需要的驱动。</div>
<div>接下来开始编写Python代码：</div>
<div>
<div>import pymongo</div>
<div>import urllib</div>
<div>import threading</div>
<div>from urllib import request</div>
<div>class ReadThread(threading.Thread):</div>
<div>def __init__(self,num):  <wbr />  <wbr />//线程初始化方法，类似java中的构造方法</div>
<div>threading.Thread.__init__(self)</div>
<div>self.num=num</div>
<div>def __run__(self):  <wbr />  <wbr />  <wbr />  <wbr />  <wbr />//复写__run__方法，也与java类似</div>
<div>client=pymongo.MongoClient('127.0.0.1',27017)</div>
<div>db=client.test  <wbr />  <wbr />  <wbr />  <wbr />  <wbr />  <wbr />  <wbr />  <wbr />  <wbr />  <wbr />  <wbr /> <wbr />//连接mongoDb数据库</div>
<div>f = open('SYS_YHMMB.txt', 'r')//打开文本文件</div>
<div>lists=f.readlines()  <wbr />  <wbr />  <wbr />  <wbr />  <wbr />  <wbr />  <wbr />  <wbr />  <wbr />  <wbr />  <wbr /> //读取文件所有行，放入列表中</div>
<div>for l in lists:  <wbr />  <wbr />  <wbr />  <wbr />  <wbr />  <wbr />  <wbr />  <wbr />  <wbr /> <wbr /></div>
<div>db.person.insert({'text':l}) //遍历列表，放入数据库中</div>
<div>db.close()  <wbr />  <wbr />  <wbr />  <wbr />  <wbr />  <wbr />  <wbr />  <wbr />  <wbr /> //关闭数据库</div>
<div>r=ReadThread(1)  <wbr />  <wbr />  <wbr />  <wbr />  <wbr />  <wbr />//创建线程</div>
<div>r.start()  <wbr />//启动线程</div>
</div>
<div></div>
<div>使用db.person.find()可以看到数据已经插入数据库了。</div>
<div><a href="http://photo.blog.sina.com.cn/showpic.html#blogid=8265bd790102vubd&amp;url=http://album.sina.com.cn/pic/002o3oc9gy6UafBvAg169" target="_blank"><img style="margin: 0px; padding: 0px; border: 0px; list-style: none;" title="Python &lt;wbr&gt;多线程读取文本文件，写入Mongodb" src="http://s10.sinaimg.cn/mw690/002o3oc9gy6UafBvAg169&amp;690" alt="Python &lt;wbr&gt;多线程读取文本文件，写入Mongodb" width="643" height="271" name="image_operate_40921437981939507" /></a></div>
</div>

	<p class="meta">Posted on <span class="postdate">Nov 01, 2016</span></p>

</article>
    </div>



  </div>



  <footer id="footer">
    <p class="copyright">Copyright &copy; 2017 Solar Theme. Powered by <a href="http://jekyllrb.com">Jekyll</a>, theme by <a href="http://www.webmaster-source.com">Matt Harzewski</a></p>
  </footer>



  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.1/jquery.min.js"></script>
  <script src="/assets/js/jquery.mobilemenu.min.js"></script>

  <script>
    $(document).ready(function(){
      $('#sidebar nav ul').mobileMenu({'topOptionText': 'Menu', 'prependTo': '#sidebar nav'});
    });
  </script>



</body>
</html>